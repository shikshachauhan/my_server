<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>cron.rake - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="../../AS_Database_sql.html">AS_Database.sql</a>
  
    <li><a href="../../Apis_txt.html">Apis</a>
  
    <li><a href="../../Gemfile.html">Gemfile</a>
  
    <li><a href="../../Gemfile_lock.html">Gemfile.lock</a>
  
    <li><a href="../../Issues.html">Issues</a>
  
    <li><a href="../../README_rdoc.html">README</a>
  
    <li><a href="../../Rakefile.html">Rakefile</a>
  
    <li><a href="../../Recordings/s1_mp3.html">s1.mp3</a>
  
    <li><a href="../../Recordings/s2_mp3.html">s2.mp3</a>
  
    <li><a href="../../Recordings/s3_mp3.html">s3.mp3</a>
  
    <li><a href="../../Recordings/s5_mp3.html">s5.mp3</a>
  
    <li><a href="../../Recordings/standard_mp3.html">standard.mp3</a>
  
    <li><a href="../../SAve.html">SAve</a>
  
    <li><a href="../../add_changes_sh.html">add_changes.sh</a>
  
    <li><a href="../../app/assets/bootstrap/css/bootstrap-theme_css.html">bootstrap-theme.css</a>
  
    <li><a href="../../app/assets/bootstrap/css/bootstrap-theme_css_map.html">bootstrap-theme.css.map</a>
  
    <li><a href="../../app/assets/bootstrap/css/bootstrap-theme_min_css.html">bootstrap-theme.min.css</a>
  
    <li><a href="../../app/assets/bootstrap/css/bootstrap_css.html">bootstrap.css</a>
  
    <li><a href="../../app/assets/bootstrap/css/bootstrap_css_map.html">bootstrap.css.map</a>
  
    <li><a href="../../app/assets/bootstrap/css/bootstrap_min_css.html">bootstrap.min.css</a>
  
    <li><a href="../../app/assets/bootstrap/fonts/glyphicons-halflings-regular_svg.html">glyphicons-halflings-regular.svg</a>
  
    <li><a href="../../app/assets/bootstrap/js/bootstrap_js.html">bootstrap.js</a>
  
    <li><a href="../../app/assets/bootstrap/js/bootstrap_min_js.html">bootstrap.min.js</a>
  
    <li><a href="../../app/assets/bootstrap/js/npm_js.html">npm.js</a>
  
    <li><a href="../../app/assets/font-awesome/less/animated_less.html">animated.less</a>
  
    <li><a href="../../app/assets/font-awesome/less/bordered-pulled_less.html">bordered-pulled.less</a>
  
    <li><a href="../../app/assets/font-awesome/less/core_less.html">core.less</a>
  
    <li><a href="../../app/assets/font-awesome/less/fixed-width_less.html">fixed-width.less</a>
  
    <li><a href="../../app/assets/font-awesome/less/font-awesome_less.html">font-awesome.less</a>
  
    <li><a href="../../app/assets/font-awesome/less/icons_less.html">icons.less</a>
  
    <li><a href="../../app/assets/font-awesome/less/larger_less.html">larger.less</a>
  
    <li><a href="../../app/assets/font-awesome/less/list_less.html">list.less</a>
  
    <li><a href="../../app/assets/font-awesome/less/mixins_less.html">mixins.less</a>
  
    <li><a href="../../app/assets/font-awesome/less/path_less.html">path.less</a>
  
    <li><a href="../../app/assets/font-awesome/less/rotated-flipped_less.html">rotated-flipped.less</a>
  
    <li><a href="../../app/assets/font-awesome/less/stacked_less.html">stacked.less</a>
  
    <li><a href="../../app/assets/font-awesome/less/variables_less.html">variables.less</a>
  
    <li><a href="../../app/assets/font-awesome/scss/_animated_scss.html">_animated.scss</a>
  
    <li><a href="../../app/assets/font-awesome/scss/_bordered-pulled_scss.html">_bordered-pulled.scss</a>
  
    <li><a href="../../app/assets/font-awesome/scss/_core_scss.html">_core.scss</a>
  
    <li><a href="../../app/assets/font-awesome/scss/_fixed-width_scss.html">_fixed-width.scss</a>
  
    <li><a href="../../app/assets/font-awesome/scss/_icons_scss.html">_icons.scss</a>
  
    <li><a href="../../app/assets/font-awesome/scss/_larger_scss.html">_larger.scss</a>
  
    <li><a href="../../app/assets/font-awesome/scss/_list_scss.html">_list.scss</a>
  
    <li><a href="../../app/assets/font-awesome/scss/_mixins_scss.html">_mixins.scss</a>
  
    <li><a href="../../app/assets/font-awesome/scss/_path_scss.html">_path.scss</a>
  
    <li><a href="../../app/assets/font-awesome/scss/_rotated-flipped_scss.html">_rotated-flipped.scss</a>
  
    <li><a href="../../app/assets/font-awesome/scss/_stacked_scss.html">_stacked.scss</a>
  
    <li><a href="../../app/assets/font-awesome/scss/_variables_scss.html">_variables.scss</a>
  
    <li><a href="../../app/assets/font-awesome/scss/font-awesome_scss.html">font-awesome.scss</a>
  
    <li><a href="../../app/assets/fonts/fontawesome-webfont_svg.html">fontawesome-webfont.svg</a>
  
    <li><a href="../../app/assets/fonts/glyphicons-halflings-regular_svg.html">glyphicons-halflings-regular.svg</a>
  
    <li><a href="../../app/assets/javascripts/application_js.html">application.js</a>
  
    <li><a href="../../app/assets/javascripts/bootstrap_js.html">bootstrap.js</a>
  
    <li><a href="../../app/assets/javascripts/bootstrap_min_js.html">bootstrap.min.js</a>
  
    <li><a href="../../app/assets/javascripts/contacts_coffee.html">contacts.coffee</a>
  
    <li><a href="../../app/assets/javascripts/jquery-1_11_1_js.html">jquery-1.11.1.js</a>
  
    <li><a href="../../app/assets/javascripts/jquery-1_11_1_min_js.html">jquery-1.11.1.min.js</a>
  
    <li><a href="../../app/assets/javascripts/jquery_backstretch_js.html">jquery.backstretch.js</a>
  
    <li><a href="../../app/assets/javascripts/jquery_backstretch_min_js.html">jquery.backstretch.min.js</a>
  
    <li><a href="../../app/assets/javascripts/jquery_js.html">jquery.js</a>
  
    <li><a href="../../app/assets/javascripts/location_coffee.html">location.coffee</a>
  
    <li><a href="../../app/assets/javascripts/ngo_users_js.html">ngo_users.js</a>
  
    <li><a href="../../app/assets/javascripts/placeholder_js.html">placeholder.js</a>
  
    <li><a href="../../app/assets/javascripts/registeradmin_js.html">registeradmin.js</a>
  
    <li><a href="../../app/assets/javascripts/scripts_js.html">scripts.js</a>
  
    <li><a href="../../app/assets/javascripts/sessions_js.html">sessions.js</a>
  
    <li><a href="../../app/assets/javascripts/survey_js.html">survey.js</a>
  
    <li><a href="../../app/assets/javascripts/users_js.html">users.js</a>
  
    <li><a href="../../app/assets/javascripts/welcome_js.html">welcome.js</a>
  
    <li><a href="../../app/assets/stylesheets/application_css.html">application.css</a>
  
    <li><a href="../../app/assets/stylesheets/application_css_sass.html">application.css.sass</a>
  
    <li><a href="../../app/assets/stylesheets/bootstrap_css.html">bootstrap.css</a>
  
    <li><a href="../../app/assets/stylesheets/bootstrap_min_css.html">bootstrap.min.css</a>
  
    <li><a href="../../app/assets/stylesheets/business-casual_css.html">business-casual.css</a>
  
    <li><a href="../../app/assets/stylesheets/contacts_scss.html">contacts.scss</a>
  
    <li><a href="../../app/assets/stylesheets/custom_css_scss.html">custom.css.scss</a>
  
    <li><a href="../../app/assets/stylesheets/font-awesome_css.html">font-awesome.css</a>
  
    <li><a href="../../app/assets/stylesheets/font-awesome_min_css.html">font-awesome.min.css</a>
  
    <li><a href="../../app/assets/stylesheets/form-elements_css.html">form-elements.css</a>
  
    <li><a href="../../app/assets/stylesheets/location_scss.html">location.scss</a>
  
    <li><a href="../../app/assets/stylesheets/ngo_users_css.html">ngo_users.css</a>
  
    <li><a href="../../app/assets/stylesheets/registeradmin_scss.html">registeradmin.scss</a>
  
    <li><a href="../../app/assets/stylesheets/sessions_scss.html">sessions.scss</a>
  
    <li><a href="../../app/assets/stylesheets/style_css.html">style.css</a>
  
    <li><a href="../../app/assets/stylesheets/survey_scss.html">survey.scss</a>
  
    <li><a href="../../app/assets/stylesheets/users_css.html">users.css</a>
  
    <li><a href="../../app/assets/stylesheets/users_scss.html">users.scss</a>
  
    <li><a href="../../app/assets/stylesheets/welcome_css.html">welcome.css</a>
  
    <li><a href="../../app/assets/stylesheets/welcome_scss.html">welcome.scss</a>
  
    <li><a href="../../app/controllers/recordings_controller_rb_backup.html">recordings_controller.rb.backup</a>
  
    <li><a href="../../app/controllers/recordings_controller_rb_save.html">recordings_controller.rb.save</a>
  
    <li><a href="../../app/views/demo.html">demo</a>
  
    <li><a href="../../app/views/registeradmins/new_html_erb_backup.html">new.html.erb.backup</a>
  
    <li><a href="../../app/views/sessions/create_html_erb_backup.html">create.html.erb.backup</a>
  
    <li><a href="../../app/views/sessions/new_html_erb_backup.html">new.html.erb.backup</a>
  
    <li><a href="../../app/views/welcome/homepage_html_erb_backup.html">homepage.html.erb.backup</a>
  
    <li><a href="../../config_ru.html">config.ru</a>
  
    <li><a href="../../crontab_sh.html">crontab.sh</a>
  
    <li><a href="../../export_proxy_sh.html">export_proxy.sh</a>
  
    <li><a href="../../exportdb_sh.html">exportdb.sh</a>
  
    <li><a href="../../importdb_sh.html">importdb.sh</a>
  
    <li><a href="../../lib/tasks/cron_rake.html">cron.rake</a>
  
    <li><a href="../../lib/tasks/test_rake.html">test.rake</a>
  
    <li><a href="../../log/cron_error_log_log.html">cron_error_log.log</a>
  
    <li><a href="../../log/cron_log_log.html">cron_log.log</a>
  
    <li><a href="../../log/development_log.html">development.log</a>
  
    <li><a href="../../log/rpush_log.html">rpush.log</a>
  
    <li><a href="../../mysql-5_6_deb.html">mysql-5.6.deb</a>
  
    <li><a href="../../newfile.html">newfile</a>
  
    <li><a href="../../nohup_out.html">nohup.out</a>
  
    <li><a href="../../public/404_html.html">404.html</a>
  
    <li><a href="../../public/422_html.html">422.html</a>
  
    <li><a href="../../public/500_html.html">500.html</a>
  
    <li><a href="../../public/assets/application-3d32947717b0eddc881b42a48c578e091681bbec584d357b91feb3a97175cc97_js.html">application-3d32947717b0eddc881b42a48c578e091681bbec584d357b91feb3a97175cc97.js</a>
  
    <li><a href="../../public/assets/application-ad88c785b1d1901929efb6c25439f90495088e2a6fe2ade781e7ad50318d6cfb_css.html">application-ad88c785b1d1901929efb6c25439f90495088e2a6fe2ade781e7ad50318d6cfb.css</a>
  
    <li><a href="../../public/assets/bootstrap/glyphicons-halflings-regular-42f60659d265c1a3c30f9fa42abcbb56bd4a53af4d83d316d6dd7a36903c43e5_svg.html">glyphicons-halflings-regular-42f60659d265c1a3c30f9fa42abcbb56bd4a53af4d83d316d6dd7a36903c43e5.svg</a>
  
    <li><a href="../../public/assets/css/bootstrap-theme_css-60f70a8c0eb101c3441486c829f9c5fe9fcf3e3efdec44371cc5612009748576_map.html">bootstrap-theme.css-60f70a8c0eb101c3441486c829f9c5fe9fcf3e3efdec44371cc5612009748576.map</a>
  
    <li><a href="../../public/assets/css/bootstrap_css-daa4aebc002864fcafd6ca2befa67d9b4ff616cf2e930027ddfa7d786a3f4346_map.html">bootstrap.css-daa4aebc002864fcafd6ca2befa67d9b4ff616cf2e930027ddfa7d786a3f4346.map</a>
  
    <li><a href="../../public/assets/fontawesome-webfont-bfdef833219a6edffd9c3cbc28db72739d22bb4d20cc2e2f8d56a7a4d408a206_svg.html">fontawesome-webfont-bfdef833219a6edffd9c3cbc28db72739d22bb4d20cc2e2f8d56a7a4d408a206.svg</a>
  
    <li><a href="../../public/assets/fonts/glyphicons-halflings-regular-42f60659d265c1a3c30f9fa42abcbb56bd4a53af4d83d316d6dd7a36903c43e5_svg.html">glyphicons-halflings-regular-42f60659d265c1a3c30f9fa42abcbb56bd4a53af4d83d316d6dd7a36903c43e5.svg</a>
  
    <li><a href="../../public/assets/glyphicons-halflings-regular-42f60659d265c1a3c30f9fa42abcbb56bd4a53af4d83d316d6dd7a36903c43e5_svg.html">glyphicons-halflings-regular-42f60659d265c1a3c30f9fa42abcbb56bd4a53af4d83d316d6dd7a36903c43e5.svg</a>
  
    <li><a href="../../public/assets/less/animated-c7035423d5a1e03d36bcfd6465481e4c4d5c91f316fa878a6e5103afe1b0bbf6_less.html">animated-c7035423d5a1e03d36bcfd6465481e4c4d5c91f316fa878a6e5103afe1b0bbf6.less</a>
  
    <li><a href="../../public/assets/less/bordered-pulled-8b19915b40da6b301577639e741079f9e5791dcecd7b915fa4dd7aa59888aa6a_less.html">bordered-pulled-8b19915b40da6b301577639e741079f9e5791dcecd7b915fa4dd7aa59888aa6a.less</a>
  
    <li><a href="../../public/assets/less/core-a6b6a6d3875fe1ced7ba444b4f57dc8390fb87bea7ab2c64d4478411748f58de_less.html">core-a6b6a6d3875fe1ced7ba444b4f57dc8390fb87bea7ab2c64d4478411748f58de.less</a>
  
    <li><a href="../../public/assets/less/fixed-width-0ef853a3192742d207ea0e793dc8bcc6322dcb9e50d41f4b981c4ebac2dac7ac_less.html">fixed-width-0ef853a3192742d207ea0e793dc8bcc6322dcb9e50d41f4b981c4ebac2dac7ac.less</a>
  
    <li><a href="../../public/assets/less/font-awesome-c730b24a6e611d3f86337f59855f1a277433b85d3867de5892253adf043d0ebd_less.html">font-awesome-c730b24a6e611d3f86337f59855f1a277433b85d3867de5892253adf043d0ebd.less</a>
  
    <li><a href="../../public/assets/less/icons-2b65d649e8c974fa97e4d5534ff0f810971260e0e8e5ebdca86ab8d087abb3e7_less.html">icons-2b65d649e8c974fa97e4d5534ff0f810971260e0e8e5ebdca86ab8d087abb3e7.less</a>
  
    <li><a href="../../public/assets/less/larger-dfc79d4325804e9ade21ab65145b23b1c4193d24a893690bc47b5c0739ca3c0a_less.html">larger-dfc79d4325804e9ade21ab65145b23b1c4193d24a893690bc47b5c0739ca3c0a.less</a>
  
    <li><a href="../../public/assets/less/list-024abb930e6669f215ddee19f58077571f1cabb7aee1274bf96b226c296b73d3_less.html">list-024abb930e6669f215ddee19f58077571f1cabb7aee1274bf96b226c296b73d3.less</a>
  
    <li><a href="../../public/assets/less/mixins-1eff996b33a52f61cf0c1456d03f586b925345fd59bb20fbc1bd18e25409f8f4_less.html">mixins-1eff996b33a52f61cf0c1456d03f586b925345fd59bb20fbc1bd18e25409f8f4.less</a>
  
    <li><a href="../../public/assets/less/path-79727cb6aa668b4515e0c6187653120129783e82e3f47e9e12a8d7b9cce59241_less.html">path-79727cb6aa668b4515e0c6187653120129783e82e3f47e9e12a8d7b9cce59241.less</a>
  
    <li><a href="../../public/assets/less/rotated-flipped-d67df95488eec84d2d0caf79727825a8ff4b2df90c604151783e3ec2388dad38_less.html">rotated-flipped-d67df95488eec84d2d0caf79727825a8ff4b2df90c604151783e3ec2388dad38.less</a>
  
    <li><a href="../../public/assets/less/stacked-3f9de6c3e0f1a2bc71579a417d7c415f82f2a3d3f4792161a8588bb8bdd75450_less.html">stacked-3f9de6c3e0f1a2bc71579a417d7c415f82f2a3d3f4792161a8588bb8bdd75450.less</a>
  
    <li><a href="../../public/assets/less/variables-fa6afd0d7feb78676dc2643c5ff9cdf243a4e19c9f3e26168aa89ba9928ead85_less.html">variables-fa6afd0d7feb78676dc2643c5ff9cdf243a4e19c9f3e26168aa89ba9928ead85.less</a>
  
    <li><a href="../../public/favicon_ico.html">favicon.ico</a>
  
    <li><a href="../../public/robots_txt.html">robots</a>
  
    <li><a href="../../rebuild_sh.html">rebuild.sh</a>
  
    <li><a href="../../sms-fu_git.html">sms-fu.git</a>
  
    <li><a href="../../speedtest-cli.html">speedtest-cli</a>
  
    <li><a href="../../tmp/rpush_pid.html">rpush.pid</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page lib/tasks/cron.rake">

<p>require “#{Rails.root}/app/helpers/application_helper” include <a
href="../../ApplicationHelper.html">ApplicationHelper</a> namespace
:tasktable do</p>

<pre class="ruby"><span class="ruby-identifier">server_ip</span>()
<span class="ruby-identifier">desc</span> <span class="ruby-string">&quot;Change each Pending status to completed&quot;</span>
<span class="ruby-identifier">task</span> :<span class="ruby-identifier">pen2com</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">environment</span> <span class="ruby-keyword">do</span>
        <span class="ruby-constant">Task</span>.<span class="ruby-identifier">find_each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">task</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;Pending&quot;</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskId</span>        
                        <span class="ruby-identifier">task</span>.<span class="ruby-identifier">update</span>(<span class="ruby-constant">Status</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;Completed&quot;</span>)
                <span class="ruby-keyword">end</span>   
        <span class="ruby-keyword">end</span>   
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Status changed at time : &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">inspect</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">desc</span> <span class="ruby-string">&quot;Change each Completed status to Pending&quot;</span>
<span class="ruby-identifier">task</span> :<span class="ruby-identifier">com2pen</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">environment</span> <span class="ruby-keyword">do</span>
        <span class="ruby-constant">Task</span>.<span class="ruby-identifier">find_each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">task</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;Completed&quot;</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskId</span>        
                        <span class="ruby-identifier">task</span>.<span class="ruby-identifier">update</span>(<span class="ruby-constant">Status</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;Pending&quot;</span>)
                <span class="ruby-keyword">end</span>   
        <span class="ruby-keyword">end</span>   
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Status changed at time : &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">inspect</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">desc</span> <span class="ruby-string">&quot;Fill block&quot;</span>
<span class="ruby-identifier">task</span> :<span class="ruby-identifier">block</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">environment</span> <span class="ruby-keyword">do</span>
        <span class="ruby-constant">Message</span>.<span class="ruby-identifier">find_each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">task</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">task</span>.<span class="ruby-identifier">update</span>(<span class="ruby-constant">Group_id</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;172&quot;</span>) 
        <span class="ruby-keyword">end</span>   
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Block filled at time : &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">inspect</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">desc</span> <span class="ruby-string">&quot;Completes all Pending message tasks&quot;</span>
<span class="ruby-identifier">task</span> :<span class="ruby-identifier">message_task</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">environment</span> <span class="ruby-keyword">do</span>
        <span class="ruby-constant">Task</span>.<span class="ruby-identifier">find_each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">task</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskName</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;LaunchMessage&quot;</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Type</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;Message&quot;</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;Pending&quot;</span>
                        <span class="ruby-identifier">msg</span> = <span class="ruby-constant">Message</span>.<span class="ruby-identifier">where</span>(<span class="ruby-constant">TextId</span><span class="ruby-operator">:</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">ItemId</span>).<span class="ruby-identifier">first</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Task &quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskId</span>.<span class="ruby-identifier">to_s</span>
                        <span class="ruby-identifier">gcmid</span> = <span class="ruby-constant">Admin</span>.<span class="ruby-identifier">find_by</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">MemberId</span>).<span class="ruby-identifier">gcmid</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot; Message &quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">task</span>.<span class="ruby-constant">ItemId</span>.<span class="ruby-identifier">to_s</span>
                        <span class="ruby-comment">#message = {&quot;gcmid&quot;: gcmid, &quot;message_id&quot;: msg.Template_id, &quot;caller_ids&quot;: task.Contacts, &quot;group_ids&quot;: task.Groups, &quot;message_args&quot;: msg.Message_params.to_s}.to_s         </span>
                        <span class="ruby-identifier">response</span> = <span class="ruby-constant">RestClient</span>.<span class="ruby-identifier">post</span>(<span class="ruby-node">&quot;http://#{@ip}:3000/message&quot;</span>, <span class="ruby-identifier">gcmid</span><span class="ruby-operator">:</span> <span class="ruby-identifier">gcmid</span>, <span class="ruby-identifier">message_id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">msg</span>.<span class="ruby-constant">Template_id</span>, <span class="ruby-identifier">caller_ids</span><span class="ruby-operator">:</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Contacts</span>, <span class="ruby-identifier">group_ids</span><span class="ruby-operator">:</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Groups</span>, <span class="ruby-identifier">message_args</span><span class="ruby-operator">:</span> <span class="ruby-identifier">msg</span>.<span class="ruby-constant">Message_params</span>.<span class="ruby-identifier">to_s</span>)
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">response</span>

                        <span class="ruby-constant">Task</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskId</span>)   <span class="ruby-comment">#delete the current task.</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;deleted task&quot;</span>
                <span class="ruby-keyword">end</span>   
        <span class="ruby-keyword">end</span>   
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Status changed at time : &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">inspect</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">desc</span> <span class="ruby-string">&quot;Completes all Pending recording tasks&quot;</span>
<span class="ruby-identifier">task</span> :<span class="ruby-identifier">recording_task</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">environment</span> <span class="ruby-keyword">do</span>
        <span class="ruby-constant">Task</span>.<span class="ruby-identifier">find_each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">task</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskName</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;LaunchRecording&quot;</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Type</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;Recording&quot;</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;Pending&quot;</span>
                        <span class="ruby-identifier">rec</span> = <span class="ruby-constant">Recording</span>.<span class="ruby-identifier">where</span>(<span class="ruby-constant">RecId</span><span class="ruby-operator">:</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">ItemId</span>).<span class="ruby-identifier">first</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Task &quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskId</span>.<span class="ruby-identifier">to_s</span>
                        <span class="ruby-identifier">gcmid</span> = <span class="ruby-constant">Admin</span>.<span class="ruby-identifier">find_by</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">MemberId</span>).<span class="ruby-identifier">gcmid</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">gcmid</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot; Recording &quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">task</span>.<span class="ruby-constant">ItemId</span>.<span class="ruby-identifier">to_s</span>
                        <span class="ruby-identifier">response</span> = <span class="ruby-constant">RestClient</span>.<span class="ruby-identifier">post</span>(<span class="ruby-node">&quot;http://#{@ip}:3000/recording&quot;</span>, <span class="ruby-identifier">gcmid</span><span class="ruby-operator">:</span> <span class="ruby-identifier">gcmid</span>, <span class="ruby-identifier">caller_ids</span><span class="ruby-operator">:</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Contacts</span> , <span class="ruby-identifier">group_ids</span><span class="ruby-operator">:</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Groups</span>, <span class="ruby-identifier">uploadedfile</span><span class="ruby-operator">:</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;Recordings/#{rec.RecFileName}&quot;</span>))
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">response</span>

                        <span class="ruby-constant">Task</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskId</span>)   <span class="ruby-comment">#delete the current task.</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;deleted task&quot;</span>
                <span class="ruby-keyword">end</span>   
        <span class="ruby-keyword">end</span>   
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Status changed at time : &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">inspect</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">desc</span> <span class="ruby-string">&quot;Completes all Pending Create Contact tasks&quot;</span>
<span class="ruby-identifier">task</span> :<span class="ruby-identifier">contact_task</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">environment</span> <span class="ruby-keyword">do</span>
        <span class="ruby-constant">Task</span>.<span class="ruby-identifier">find_each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">task</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskName</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;CreateContact&quot;</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Type</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;Contact&quot;</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;Pending&quot;</span>
                        <span class="ruby-identifier">con</span> = <span class="ruby-constant">Contact</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">ItemId</span>).<span class="ruby-identifier">first</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Task &quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskId</span>.<span class="ruby-identifier">to_s</span>
                        <span class="ruby-identifier">gcmid</span> = <span class="ruby-constant">Admin</span>.<span class="ruby-identifier">find_by</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">MemberId</span>).<span class="ruby-identifier">gcmid</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">gcmid</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot; Contact &quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">task</span>.<span class="ruby-constant">ItemId</span>.<span class="ruby-identifier">to_s</span>
                        <span class="ruby-identifier">response</span> = <span class="ruby-constant">RestClient</span>.<span class="ruby-identifier">post</span>(<span class="ruby-node">&quot;http://#{@ip}:3000/contact&quot;</span>, <span class="ruby-identifier">gcmid</span><span class="ruby-operator">:</span> <span class="ruby-identifier">gcmid</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-identifier">con</span>.<span class="ruby-constant">Name</span>, <span class="ruby-identifier">number</span><span class="ruby-operator">:</span> <span class="ruby-identifier">con</span>.<span class="ruby-constant">Number</span>, <span class="ruby-identifier">gender</span><span class="ruby-operator">:</span> <span class="ruby-identifier">con</span>.<span class="ruby-constant">Gender</span>, <span class="ruby-identifier">clist_ids</span><span class="ruby-operator">:</span> <span class="ruby-identifier">con</span>.<span class="ruby-constant">Clist_ids</span>, <span class="ruby-identifier">resource_uri</span><span class="ruby-operator">:</span> <span class="ruby-identifier">con</span>.<span class="ruby-constant">Resource_uri</span>, <span class="ruby-identifier">age</span><span class="ruby-operator">:</span> <span class="ruby-identifier">con</span>.<span class="ruby-constant">Age</span>, <span class="ruby-identifier">district</span><span class="ruby-operator">:</span> <span class="ruby-identifier">con</span>.<span class="ruby-constant">District</span>, <span class="ruby-identifier">block</span><span class="ruby-operator">:</span> <span class="ruby-identifier">con</span>.<span class="ruby-constant">Block</span>, <span class="ruby-identifier">state</span><span class="ruby-operator">:</span> <span class="ruby-identifier">con</span>.<span class="ruby-constant">State</span>, <span class="ruby-identifier">location</span><span class="ruby-operator">:</span> <span class="ruby-identifier">con</span>.<span class="ruby-constant">Location</span>)
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">response</span>

                        <span class="ruby-constant">Task</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskId</span>)   <span class="ruby-comment">#delete the current task.</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;deleted task&quot;</span>
                <span class="ruby-keyword">end</span>   
        <span class="ruby-keyword">end</span>   
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Status changed at time : &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">inspect</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">desc</span> <span class="ruby-string">&quot;Completes all Pending Create ContactList tasks&quot;</span>
<span class="ruby-identifier">task</span> :<span class="ruby-identifier">contactlist_task</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">environment</span> <span class="ruby-keyword">do</span>
        <span class="ruby-constant">Task</span>.<span class="ruby-identifier">find_each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">task</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskName</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;CreateContactList&quot;</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Type</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;ContactList&quot;</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;Pending&quot;</span>
                        <span class="ruby-identifier">con</span> = <span class="ruby-constant">Group</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">ItemId</span>).<span class="ruby-identifier">first</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Task &quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskId</span>.<span class="ruby-identifier">to_s</span>
                        <span class="ruby-identifier">gcmid</span> = <span class="ruby-constant">Admin</span>.<span class="ruby-identifier">find_by</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">MemberId</span>).<span class="ruby-identifier">gcmid</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">gcmid</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot; ContactList &quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">task</span>.<span class="ruby-constant">ItemId</span>.<span class="ruby-identifier">to_s</span>
                        <span class="ruby-identifier">response</span> = <span class="ruby-constant">RestClient</span>.<span class="ruby-identifier">post</span>(<span class="ruby-node">&quot;http://#{@ip}:3000/contactlist&quot;</span>, <span class="ruby-identifier">gcmid</span><span class="ruby-operator">:</span> <span class="ruby-identifier">gcmid</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-identifier">con</span>.<span class="ruby-constant">Name</span>)
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">response</span>

                        <span class="ruby-constant">Task</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskId</span>)   <span class="ruby-comment">#delete the current task.</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;deleted task&quot;</span>
                <span class="ruby-keyword">end</span>   
        <span class="ruby-keyword">end</span>   
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Status changed at time : &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">inspect</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">desc</span> <span class="ruby-string">&quot;Completes all Pending survey tasks&quot;</span>
<span class="ruby-identifier">task</span> :<span class="ruby-identifier">survey_task</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">environment</span> <span class="ruby-keyword">do</span>
        <span class="ruby-constant">Task</span>.<span class="ruby-identifier">find_each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">task</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">Status</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;Completed&quot;</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">task</span>.<span class="ruby-constant">TaskId</span>        
                        <span class="ruby-identifier">task</span>.<span class="ruby-identifier">update</span>(<span class="ruby-constant">Status</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;Pending&quot;</span>)
                <span class="ruby-keyword">end</span>   
        <span class="ruby-keyword">end</span>   
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Status changed at time : &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">inspect</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">desc</span> <span class="ruby-string">&quot;Change each Completed status to Pending&quot;</span>
<span class="ruby-identifier">task</span> :<span class="ruby-identifier">cronjob</span> =<span class="ruby-operator">&gt;</span> [:<span class="ruby-identifier">message_task</span>, :<span class="ruby-identifier">recording_task</span>, :<span class="ruby-identifier">survey_task</span>] <span class="ruby-keyword">do</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;All pending tasks completed at : &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">inspect</span>
<span class="ruby-keyword">end</span>
</pre>

<p>end</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.2.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

